import cv2

def record_video(output_filename='output.avi', duration=10):
    cap = cv2.VideoCapture(0)
    if not cap.isOpened():
        print("Error: Cannot open webcam")
        return

    # Define the codec and create VideoWriter object
    fourcc = cv2.VideoWriter_fourcc(*'XVID')
    fps = 20.0
    frame_size = (int(cap.get(3)), int(cap.get(4)))
    out = cv2.VideoWriter(output_filename, fourcc, fps, frame_size)

    print("Recording... Press 'q' to stop early.")
    frames_recorded = 0
    max_frames = int(fps * duration)

    while frames_recorded < max_frames:
        ret, frame = cap.read()
        if not ret:
            break
        out.write(frame)
        cv2.imshow('Recording', frame)
        frames_recorded += 1

        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    cap.release()
    out.release()
    cv2.destroyAllWindows()
    print(f"Recording saved to {output_filename}")

def play_video(filename='output.avi'):
    cap = cv2.VideoCapture(filename)

    if not cap.isOpened():
        print("Error: Cannot open video file")
        return

    print("Playing video... Press 'q' to quit.")
    while cap.isOpened():
        ret, frame = cap.read()
        if not ret:
            break
        cv2.imshow('Playback', frame)
        if cv2.waitKey(30) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()

if __name__ == "__main__":
    record_video('my_video.avi', duration=10)  # record 10 seconds
    play_video('my_video.avi')                 # then play it back
